description: "Contextual Security Tests"

section:
- name: "Privileged Plan Enforcement"
  tests:
  - name: "Compliant Tool Call (Allow)"
    input:
      agent:
        # Note: description is important below. It's used to fetch mocked history content.
        expr: >
          Agent{
            description: "contextual_security_mixed" 
          }
      tool:
        expr: >
          ToolCall{ name: "calculator" }
    output: >
      {
        "effect": "allow", 
        "message": ""
      }

  - name: "Non-Compliant Tool Call (Deny)"
    input:
      agent:
        expr: >
          Agent{
            description: "contextual_security_mixed"
          }
      tool:
        expr: >
          ToolCall{ name: "file_deleter" }
    output: >
      {
        "effect": "deny",
        "message": "Tool call violated the privileged execution plan. This tool is not authorized for this context."
      }