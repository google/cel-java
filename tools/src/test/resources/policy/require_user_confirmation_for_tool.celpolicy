name: "require_user_confirmation_for_mcp_tool"
default: deny

variables:
  - high_confidence_pii: >
      tool.call.sensitivityFindings('pii').hasAll([ai.finding("pii_score", 0.8)])

rules:
  - description: "Confirm tool calls if high-confidence PII is detected"
    condition: >
      variables.high_confidence_pii &&
      !tool.call.user_confirmed
    effect: confirm
    message: "This tool call contains sensitive data (PII). User confirmation is required."
  - description: "Allow if no high-confidence PII is detected OR if confirmed"
    condition: >
      !variables.high_confidence_pii ||
      tool.call.user_confirmed
    effect: allow