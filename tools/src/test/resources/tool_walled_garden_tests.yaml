description: "Tool Restriction Tests"

section:
- name: "Allowlist Enforcement"
  tests:
  - name: "Allowed Tool (Google Search)"
    input:
      tool:
        expr: >
          ToolCall{ name: "google_search" }
    output: >
      {
        "effect": "allow",
        "message": ""
      }

  - name: "Disallowed Tool (Random Tool)"
    input:
      tool:
        expr: >
          ToolCall{ name: "random_3p_tool" }
    output: >
      {
        "effect": "deny",
        "message": "Tool access restricted. This tool is not in the allowlist."
      }