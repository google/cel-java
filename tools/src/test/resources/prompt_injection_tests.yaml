description: "Prompt Injection Policy Tests"

section:
- name: "Injection Classification Scenarios"
  tests:
  - name: "High Confidence Injection (Deny)"
    input:
      ctx:
        expr: >
          AgentRequestContext{
            agent: Agent{
              input: AgentMessage{
                parts: [
                  AgentMessage.Part{
                    prompt: ContentPart{
                      content: "INJECTION_ATTACK detected"
                    }
                  }
                ]
              }
            }
          }
    output: >
      {
        "effect": "deny",
        "message": "Prompt injection detected with high confidence."
      }

  - name: "Medium Confidence Injection (Confirm)"
    input:
      ctx:
        expr: >
          AgentRequestContext{
            agent: Agent{
              input: AgentMessage{
                parts: [
                  AgentMessage.Part{
                    prompt: ContentPart{
                      content: "This looks SUSPICIOUS but maybe safe"
                    }
                  }
                ]
              }
            }
          }
    output: >
      {
        "effect": "confirm",
        "message": "Potential prompt injection detected. User confirmation required."
      }

  - name: "Safe Input (Allow)"
    input:
      ctx:
        expr: >
          AgentRequestContext{
            agent: Agent{
              input: AgentMessage{
                parts: [
                  AgentMessage.Part{
                    prompt: ContentPart{
                      content: "Just a normal user query"
                    }
                  }
                ]
              }
            }
          }
    output: >
      {
        "effect": "allow",
        "message": ""
      }
