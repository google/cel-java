load("@rules_java//java:defs.bzl", "java_library")

package(
    default_applicable_licenses = ["//:license"],
    default_visibility = [
        "//runtime/planner:__pkg__",
    ],
)

java_library(
    name = "program_planner",
    srcs = ["ProgramPlanner.java"],
    tags = [
    ],
    deps = [
        ":attribute",
        ":error_metadata",
        ":eval_and",
        ":eval_attribute",
        ":eval_conditional",
        ":eval_const",
        ":eval_create_list",
        ":eval_create_map",
        ":eval_create_struct",
        ":eval_fold",
        ":eval_late_bound_call",
        ":eval_or",
        ":eval_test_only",
        ":eval_unary",
        ":eval_var_args_call",
        ":eval_zero_arity",
        ":interpretable_attribute",
        ":planned_interpretable",
        ":planned_program",
        ":qualifier",
        ":string_qualifier",
        "//:auto_value",
        "//common:cel_ast",
        "//common:container",
        "//common:operator",
        "//common:options",
        "//common/annotations",
        "//common/ast",
        "//common/exceptions:overload_not_found",
        "//common/types",
        "//common/types:type_providers",
        "//common/values",
        "//common/values:cel_value_provider",
        "//runtime:dispatcher",
        "//runtime:evaluation_exception",
        "//runtime:evaluation_exception_builder",
        "//runtime:program",
        "//runtime:resolved_overload",
        "@maven//:com_google_code_findbugs_annotations",
        "@maven//:com_google_errorprone_error_prone_annotations",
        "@maven//:com_google_guava_guava",
    ],
)

java_library(
    name = "planned_program",
    srcs = ["PlannedProgram.java"],
    deps = [
        ":error_metadata",
        ":execution_frame",
        ":localized_evaluation_exception",
        ":planned_interpretable",
        "//:auto_value",
        "//common:options",
        "//common/exceptions:runtime_exception",
        "//common/values",
        "//runtime",
        "//runtime:activation",
        "//runtime:evaluation_exception",
        "//runtime:evaluation_exception_builder",
        "//runtime:function_resolver",
        "//runtime:interpretable",
        "//runtime:program",
        "//runtime:resolved_overload",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "eval_const",
    srcs = ["EvalConstant.java"],
    deps = [
        ":execution_frame",
        ":planned_interpretable",
        "//runtime:interpretable",
        "@maven//:com_google_errorprone_error_prone_annotations",
        "@maven//:com_google_guava_guava",
    ],
)

java_library(
    name = "interpretable_attribute",
    srcs = ["InterpretableAttribute.java"],
    deps = [
        ":planned_interpretable",
        ":qualifier",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "attribute",
    srcs = [
        "Attribute.java",
        "AttributeFactory.java",
        "MaybeAttribute.java",
        "MissingAttribute.java",
        "NamespacedAttribute.java",
        "RelativeAttribute.java",
    ],
    deps = [
        ":eval_helpers",
        ":execution_frame",
        ":planned_interpretable",
        ":qualifier",
        "//common:container",
        "//common/exceptions:attribute_not_found",
        "//common/types",
        "//common/types:type_providers",
        "//common/values",
        "//common/values:cel_value",
        "//runtime:interpretable",
        "@maven//:com_google_errorprone_error_prone_annotations",
        "@maven//:com_google_guava_guava",
    ],
)

java_library(
    name = "qualifier",
    srcs = ["Qualifier.java"],
    deps = [
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "presence_test_qualifier",
    srcs = ["PresenceTestQualifier.java"],
    deps = [
        ":attribute",
        ":qualifier",
        "//common/values",
    ],
)

java_library(
    name = "string_qualifier",
    srcs = ["StringQualifier.java"],
    deps = [
        ":qualifier",
        "//common/exceptions:attribute_not_found",
        "//common/values",
    ],
)

java_library(
    name = "eval_attribute",
    srcs = ["EvalAttribute.java"],
    deps = [
        ":attribute",
        ":execution_frame",
        ":interpretable_attribute",
        ":qualifier",
        "//runtime:interpretable",
        "@maven//:com_google_errorprone_error_prone_annotations",
        "@maven//:com_google_guava_guava",
    ],
)

java_library(
    name = "eval_test_only",
    srcs = ["EvalTestOnly.java"],
    deps = [
        ":execution_frame",
        ":interpretable_attribute",
        ":presence_test_qualifier",
        ":qualifier",
        "//runtime:evaluation_exception",
        "//runtime:interpretable",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)

java_library(
    name = "eval_zero_arity",
    srcs = ["EvalZeroArity.java"],
    deps = [
        ":execution_frame",
        ":planned_interpretable",
        "//common/values",
        "//common/values:cel_value",
        "//runtime:evaluation_exception",
        "//runtime:interpretable",
        "//runtime:resolved_overload",
    ],
)

java_library(
    name = "eval_unary",
    srcs = ["EvalUnary.java"],
    deps = [
        ":eval_helpers",
        ":execution_frame",
        ":planned_interpretable",
        "//common/values",
        "//common/values:cel_value",
        "//runtime:evaluation_exception",
        "//runtime:interpretable",
        "//runtime:resolved_overload",
    ],
)

java_library(
    name = "eval_var_args_call",
    srcs = ["EvalVarArgsCall.java"],
    deps = [
        ":eval_helpers",
        ":execution_frame",
        ":planned_interpretable",
        "//common/values",
        "//common/values:cel_value",
        "//runtime:evaluation_exception",
        "//runtime:interpretable",
        "//runtime:resolved_overload",
    ],
)

java_library(
    name = "eval_late_bound_call",
    srcs = ["EvalLateBoundCall.java"],
    deps = [
        ":eval_helpers",
        ":execution_frame",
        ":planned_interpretable",
        "//common/exceptions:overload_not_found",
        "//common/values",
        "//common/values:cel_value",
        "//runtime:evaluation_exception",
        "//runtime:interpretable",
        "//runtime:resolved_overload",
        "@maven//:com_google_guava_guava",
    ],
)

java_library(
    name = "eval_or",
    srcs = ["EvalOr.java"],
    deps = [
        ":eval_helpers",
        ":execution_frame",
        ":planned_interpretable",
        "//common/values",
        "//runtime:interpretable",
        "@maven//:com_google_guava_guava",
    ],
)

java_library(
    name = "eval_and",
    srcs = ["EvalAnd.java"],
    deps = [
        ":eval_helpers",
        ":execution_frame",
        ":planned_interpretable",
        "//common/values",
        "//runtime:interpretable",
        "@maven//:com_google_guava_guava",
    ],
)

java_library(
    name = "eval_conditional",
    srcs = ["EvalConditional.java"],
    deps = [
        ":execution_frame",
        ":planned_interpretable",
        "//runtime:evaluation_exception",
        "//runtime:interpretable",
        "@maven//:com_google_guava_guava",
    ],
)

java_library(
    name = "eval_create_struct",
    srcs = ["EvalCreateStruct.java"],
    deps = [
        ":execution_frame",
        ":planned_interpretable",
        "//common/types",
        "//common/values",
        "//common/values:cel_value_provider",
        "//runtime:evaluation_exception",
        "//runtime:interpretable",
        "@maven//:com_google_errorprone_error_prone_annotations",
        "@maven//:com_google_guava_guava",
    ],
)

java_library(
    name = "eval_create_list",
    srcs = ["EvalCreateList.java"],
    deps = [
        ":execution_frame",
        ":planned_interpretable",
        "//runtime:evaluation_exception",
        "//runtime:interpretable",
        "@maven//:com_google_errorprone_error_prone_annotations",
        "@maven//:com_google_guava_guava",
    ],
)

java_library(
    name = "eval_create_map",
    srcs = ["EvalCreateMap.java"],
    deps = [
        ":execution_frame",
        ":localized_evaluation_exception",
        ":planned_interpretable",
        "//common/exceptions:duplicate_key",
        "//runtime:evaluation_exception",
        "//runtime:interpretable",
        "@maven//:com_google_errorprone_error_prone_annotations",
        "@maven//:com_google_guava_guava",
    ],
)

java_library(
    name = "eval_fold",
    srcs = ["EvalFold.java"],
    deps = [
        ":execution_frame",
        ":planned_interpretable",
        "//runtime:concatenated_list_view",
        "//runtime:evaluation_exception",
        "//runtime:interpretable",
        "@maven//:com_google_errorprone_error_prone_annotations",
        "@maven//:com_google_guava_guava",
        "@maven//:org_jspecify_jspecify",
    ],
)

java_library(
    name = "execution_frame",
    srcs = ["ExecutionFrame.java"],
    deps = [
        "//common:options",
        "//common/exceptions:iteration_budget_exceeded",
        "//runtime:evaluation_exception",
        "//runtime:function_resolver",
        "//runtime:resolved_overload",
    ],
)

java_library(
    name = "eval_helpers",
    srcs = ["EvalHelpers.java"],
    deps = [
        ":execution_frame",
        ":localized_evaluation_exception",
        ":planned_interpretable",
        "//common:error_codes",
        "//common/exceptions:runtime_exception",
        "//common/values",
        "//runtime:interpretable",
    ],
)

java_library(
    name = "localized_evaluation_exception",
    srcs = ["LocalizedEvaluationException.java"],
    deps = [
        "//common:error_codes",
        "//common/exceptions:runtime_exception",
    ],
)

java_library(
    name = "error_metadata",
    srcs = ["ErrorMetadata.java"],
    deps = [
        "//runtime:metadata",
        "@maven//:com_google_errorprone_error_prone_annotations",
        "@maven//:com_google_guava_guava",
    ],
)

java_library(
    name = "planned_interpretable",
    srcs = ["PlannedInterpretable.java"],
    deps = [
        ":execution_frame",
        "//runtime:evaluation_exception",
        "//runtime:interpretable",
        "@maven//:com_google_errorprone_error_prone_annotations",
    ],
)
